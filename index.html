<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WORK IN PROGRESS — DialogAI</title>
  <meta name="robots" content="noindex,nofollow" />
  <meta name="color-scheme" content="light dark" />
  <meta property="og:title" content="WORK IN PROGRESS — DialogAI" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="WORK IN PROGRESS — DialogAI" />

  <!-- Nagłówek: nowoczesna, techniczna typografia -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --header-h: clamp(72px, 9vw, 116px);
      --widget-offset-top: 0px; /* ustawiane dynamicznie na mobilu podczas ekspansji */
      --bg-top:#f6f8ff; --bg-mid:#ecf1ff; --bg-bot:#e7ecfb;
      --ink:#0f1733; --brand:#3558e6; --stroke: rgba(16,23,51,.12);
      --card: rgba(255,255,255,.72); --card-b: rgba(16,23,51,.14);
    }
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Inter, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1000px 700px at 78% 12%, rgba(53,88,230,.16), transparent 60%),
        radial-gradient(800px 600px at 18% 86%, rgba(53,88,230,.10), transparent 55%),
        linear-gradient(180deg, var(--bg-top), var(--bg-mid) 50%, var(--bg-bot) 100%);
      min-height:100dvh; overflow:auto;
      padding-top: calc(var(--header-h) + env(safe-area-inset-top));
    }

    /* Nagłówek — zawsze ponad widżetem, widoczny także na mobilu */
    header{
      position:fixed; top:0; left:0; right:0; height:var(--header-h);
      z-index:2147483647;
      display:flex; align-items:center; justify-content:center;
      background: linear-gradient(180deg, #f8faff, #eaf0ff);
      border-bottom:1px solid rgba(53,88,230,.28);
      box-shadow:0 2px 8px rgba(10,20,40,.06);
    }
    header .logo{ height: calc(var(--header-h) - 12px); width:auto; display:block; image-rendering:auto; }

    /* Mobil: nagłówek całkowicie kryjący */
    @media (max-width: 640px){
      header{ background:#ffffff; box-shadow:0 4px 12px rgba(10,20,40,.08); border-bottom:1px solid rgba(16,23,51,.12); }
      body{ padding-top: calc(var(--header-h) + env(safe-area-inset-top)); }
    }

    /* Efekty tła */
    .fx { position:fixed; inset:0; z-index:0; pointer-events:none; }
    .scan{ position:fixed; left:0; right:0; top:var(--header-h); height:2px; z-index:0; pointer-events:none;
      background: linear-gradient(90deg, transparent, rgba(53,88,230,.45), transparent);
      filter: blur(.5px); opacity:.55; animation: sweep 6s linear infinite; }
    @keyframes sweep{ 0%{ transform:translateY(0);} 100%{ transform:translateY(100vh);} }

    main{ position:relative; z-index:1; min-height:calc(100dvh - var(--header-h));
      display:grid; place-items:center; padding:28px; text-align:center; }

    /* Kapsuła WIP — cienka ramka, halo tylko wewnątrz */
    .capsule{ position:relative; padding: clamp(12px, 1.8vw, 18px); border-radius:20px;
      background: var(--card); border:1px solid var(--card-b);
      -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
      box-shadow: 0 12px 30px rgba(10,20,40,.08), inset 0 0 0 1px rgba(255,255,255,.45);
      transition: opacity .24s ease, transform .24s ease; overflow:hidden; }
    .capsule.fade-out{ opacity:0; transform: scale(.98); }

    /* Halo: dwa przeciwbieżne pierścienie, mieszczą się wewnątrz ramki */
    .capsule::before{ content:""; position:absolute; inset:10px; border-radius:12px; z-index:0;
      background: conic-gradient(from 0deg, rgba(53,88,230,.28) 0%, rgba(53,88,230,0) 22%, rgba(88,130,255,.22) 40%, rgba(53,88,230,0) 58%, rgba(130,170,255,.20) 75%, rgba(53,88,230,0) 100%);
      filter: blur(10px); animation: haloA 12s linear infinite; pointer-events:none; }
    .capsule::after{ content:""; position:absolute; inset:16px; border-radius:10px; z-index:0;
      background: conic-gradient(from 180deg, rgba(20,35,80,.18) 0%, transparent 30%, rgba(35,60,150,.12) 55%, transparent 85%, rgba(20,35,80,.18) 100%);
      filter: blur(12px); animation: haloB 18s linear infinite reverse; pointer-events:none; }
    @keyframes haloA{ to { transform: rotate(360deg); } } @keyframes haloB{ to { transform: rotate(-360deg); } }

    .title{ margin:0; font-weight:800; text-transform:uppercase; letter-spacing:.18em;
      font-size: clamp(28px, 6vw, 64px); line-height:1.06;
      background: linear-gradient(180deg, #0e142b, #2a3a72 60%, var(--brand));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow: 0 0 18px rgba(53,88,230,.18); }
    .capsule > * { position: relative; z-index: 1; }

    @media (prefers-reduced-motion: reduce){ .scan{ animation:none; } .capsule::before, .capsule::after{ animation:none; } }

    /* **Kluczowe**: host widżetu dosuwany pod nagłówek na mobilu, bez ingerencji w atrybuty */
    elevenlabs-convai{ display:block; margin-top: var(--widget-offset-top, 0px); }
  </style>
</head>
<body>
  <header aria-label="Górny baner z logo">
    <img class="logo" alt="DialogAI — logo" loading="eager" decoding="async" fetchpriority="high" src="Log.png" />
  </header>

  <!-- Efekty tła -->
  <canvas class="fx" id="constellation" aria-hidden="true"></canvas>
  <div class="scan" aria-hidden="true"></div>

  <main role="main" aria-label="Strona w budowie">
    <div id="wipCapsule" class="capsule" aria-live="polite">
      <h1 class="title">WORK IN PROGRESS</h1>
    </div>
  </main>

  <!-- Widżet ElevenLabs — bez dodatkowych atrybutów -->
  <elevenlabs-convai agent-id="agent_7401k7wfem7mef4s6sxve96pebep"></elevenlabs-convai><script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>

  <!-- FX + logika: galaktyki, WIP po kliknięciu znika i wraca po zminimalizowaniu; mobile dosunięcie widżetu -->
  <script>
    (function(){
      /* ====== CONSTELLATION FX (galaktyki) ====== */
      const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const canvas = document.getElementById('constellation'); const ctx = canvas.getContext('2d');
      let dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1)); let w, h, points, t = 0, running = !prefersReduced;
      function resize(){ w = canvas.width = Math.floor(innerWidth*dpr); h = canvas.height = Math.floor(innerHeight*dpr); canvas.style.width = innerWidth+'px'; canvas.style.height = innerHeight+'px'; initPoints(); }
      function initPoints(){ const density = 0.00015; const count = Math.max(40, Math.floor(w*h*density/(dpr*dpr))); points = []; for(let i=0;i<count;i++){ points.push({ x:Math.random()*w, y:Math.random()*h, vx:(Math.random()*2-1)*0.10*dpr, vy:(Math.random()*2-1)*0.10*dpr, ph: Math.random()*Math.PI*2 }); } }
      function step(){ if(!running) return; ctx.clearRect(0,0,w,h); t += 0.02; for(const p of points){ p.x+=p.vx; p.y+=p.vy; if(p.x<0||p.x>w) p.vx*=-1; if(p.y<0||p.y>h) p.vy*=-1; } const th = 130*dpr; for(let i=0;i<points.length;i++){ const p=points[i]; for(let j=i+1;j<points.length;j++){ const q=points[j]; const dx=p.x-q.x, dy=p.y-q.y; const dist=Math.hypot(dx,dy); if(dist<th){ const a=(1-dist/th)*0.45; ctx.strokeStyle='rgba(53,88,230,'+a+')'; ctx.lineWidth=1*dpr; ctx.beginPath(); ctx.moveTo(p.x,p.y); ctx.lineTo(q.x,q.y); ctx.stroke(); } }} ctx.fillStyle='rgba(53,88,230,0.75)'; for(const p of points){ ctx.beginPath(); ctx.arc(p.x,p.y,(1.0+0.5*Math.sin(t+p.ph))*dpr,0,Math.PI*2); ctx.fill(); } requestAnimationFrame(step); }
      document.addEventListener('visibilitychange',()=>{ running=!prefersReduced && document.visibilityState==='visible'; if(running) requestAnimationFrame(step); }); addEventListener('resize', resize); resize(); if(running) requestAnimationFrame(step);

      /* ====== WIDGET/WIP LOGIC ====== */
      const wip = document.getElementById('wipCapsule');
      const placeholder = document.createComment('WIP placeholder');
      const parent = wip.parentNode;
      let userInteracted = false; let wipRemoved = false;
      function removeWip(){ if(wipRemoved) return; wip.classList.add('fade-out'); setTimeout(()=>{ if(wip.parentNode){ parent.replaceChild(placeholder, wip); } wipRemoved = true; }, 240); }
      function restoreWip(){ if(!wipRemoved) return; if(placeholder.parentNode){ placeholder.replaceWith(wip); } wip.classList.remove('fade-out'); wipRemoved = false; }

      function largestVisibleRect(root){ let max=0, rect=null; const walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT); while(walker.nextNode()){ const el = walker.currentNode; const cs = getComputedStyle(el); if(cs.visibility==='hidden' || cs.display==='none' || cs.opacity==='0') continue; const r = el.getBoundingClientRect(); if(r.width<=0 || r.height<=0) continue; if((cs.position==='fixed' || cs.position==='absolute' || cs.position==='sticky') && r.width*r.height>max){ max=r.width*r.height; rect=r; } } return rect; }
      function getState(widget){
        try{ const sr = widget.shadowRoot; if(sr){ const big = largestVisibleRect(sr); const hasInput = sr.querySelector('textarea, input[type="text"], input[role="textbox"]'); if(big){ const area = big.width*big.height; const expanded = area > 90000 || (area>60000 && !!hasInput); const minimized = area < 40000; return { expanded, minimized }; } } }catch(e){}
        const r = widget.getBoundingClientRect(); return { expanded: (r.width>260 || r.height>320), minimized: (r.width<=180 && r.height<=180) };
      }
      function evaluate(widget){
        const {expanded, minimized} = getState(widget);
        if(!userInteracted) return;
        if(expanded){
          removeWip();
          // **Mobil**: dociśnij host widżetu poniżej nagłówka przez CSS var, bez zmian atrybutów
          if(matchMedia('(max-width: 640px)').matches){
            document.documentElement.style.setProperty('--widget-offset-top', getComputedStyle(document.documentElement).getPropertyValue('--header-h') || '64px');
          }
        } else if(minimized){
          restoreWip();
          if(matchMedia('(max-width: 640px)').matches){
            document.documentElement.style.setProperty('--widget-offset-top', '0px');
          }
        }
      }
      function bindWidget(){ const widget = document.querySelector('elevenlabs-convai'); if(!widget) return false; document.addEventListener('pointerdown', (ev)=>{ const path = ev.composedPath ? ev.composedPath() : (ev.path||[]); if(path.includes(widget)){ userInteracted = true; setTimeout(()=> evaluate(widget), 150); setTimeout(()=> evaluate(widget), 450); } }, true); const ro = new ResizeObserver(()=> evaluate(widget)); ro.observe(widget); const mo1 = new MutationObserver(()=> evaluate(widget)); mo1.observe(widget, { attributes:true, subtree:true, childList:true }); try{ if(widget.shadowRoot){ const mo2 = new MutationObserver(()=> evaluate(widget)); mo2.observe(widget.shadowRoot, { attributes:true, subtree:true, childList:true }); } }catch(e){} setInterval(()=> evaluate(widget), 350); restoreWip(); return true; }
      if(!bindWidget()){ const id = setInterval(()=>{ if(bindWidget()) clearInterval(id); }, 400); setTimeout(()=> clearInterval(id), 12000); }
    })();
  </script>

  <noscript>Wymagany jest JavaScript, aby wyświetlić animację i widżet ElevenLabs.</noscript>
  <script>
    function fallbackLogo(){
      const svgNS='http://www.w3.org/2000/svg';
      const svg=document.createElementNS(svgNS,'svg');
      svg.setAttribute('viewBox','0 0 256 256');
      svg.setAttribute('aria-label','DialogAI — logo (zapasowe)');
      svg.setAttribute('class','logo');
      // dymek
      const g=document.createElementNS(svgNS,'g');
      const path=document.createElementNS(svgNS,'path');
      path.setAttribute('fill','var(--brand)');
      path.setAttribute('d','M48 48h144c13.3 0 24 10.7 24 24v80c0 13.3-10.7 24-24 24H108l-28 28v-28H48c-13.3 0-24-10.7-24-24V72c0-13.3 10.7-24 24-24z');
      g.appendChild(path);
      // robot
      const face=document.createElementNS(svgNS,'rect');
      face.setAttribute('x','84'); face.setAttribute('y','92'); face.setAttribute('width','88'); face.setAttribute('height','56'); face.setAttribute('rx','12'); face.setAttribute('fill','#ffffff');
      const eyeL=document.createElementNS(svgNS,'circle'); eyeL.setAttribute('cx','110'); eyeL.setAttribute('cy','120'); eyeL.setAttribute('r','8'); eyeL.setAttribute('fill','var(--brand)');
      const eyeR=document.createElementNS(svgNS,'circle'); eyeR.setAttribute('cx','146'); eyeR.setAttribute('cy','120'); eyeR.setAttribute('r','8'); eyeR.setAttribute('fill','var(--brand)');
      const ant=document.createElementNS(svgNS,'rect'); ant.setAttribute('x','122'); ant.setAttribute('y','78'); ant.setAttribute('width','12'); ant.setAttribute('height','20'); ant.setAttribute('rx','6'); ant.setAttribute('fill','var(--brand)');
      g.appendChild(face); g.appendChild(eyeL); g.appendChild(eyeR); g.appendChild(ant);
      svg.appendChild(g);
      return svg;
    }
  </script>
</body>
</html>
